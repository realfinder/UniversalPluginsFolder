<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<title>vcmohan's Reformer Plugin Filter For AviSynth </title>
</head>

<body>
	   <font color="#cc0033"><h1>Reformer </h1></font>
	 
	  <BR><b><a href="vcmohan.html">Author V. C. Mohan</a></b>
	  <BR> Aug 2014
	  
	  <p>This plugin probably is better suited than Reform plugin as it performs
	   much better even if the rectangle is rotated by 90 degrees. Reform fails 
	   in such a situation. This Reformer uses matrix algebra for transformations
	   unlike Reform which does a geometric transform. </p>
	   
<P> Reformer has two functions  viz: r2q and q2r. As the names suggest r2q 
transforms rectangle to a quadrilateral, while q2r transforms quadrilateral
 to rectangle. Lanczos or cubic or linear or nearest point interpolation methods
  can be opted. The parameters are identical to both functions (and to the
   Reform plugin.) and the coordinates can be specified as floating point
    or (since avisynth accepts integers as floating point) in integer format.
 </p>
 <p> While there are no limits for specifying parameters, it has to be ensured that 
 the specified parameters do not twist or fold the Quadrlateral. In the table of
  parameters R stands for Rectangle and Q stands for Quadrilateral.</P>
<p>Most of the parameters can be linearly varied over the length of the clip, and so
it can be used to distort or correct distorted faces or objects progressively.
 Also can be used by proper scripting as transition. 
All color formats supported by Avisynth version are accepted. For reading coordinates 
 correctly my plugin 
<a href="../Grid/Grid.html">Grid</a> can be used.</p>

<p>
<table border="2" bordercolor="#c0c0c0">

<caption align="center">Description of parameters. Q stands for Quadrilateral
 and R for rectangle.</caption>
<tr>
       <td><strong><font color="#cc0066">Parameter</font></strong></td>
       <td><strong><font color="#cc0066">Parameter name</font></strong></td>
	   <td><strong><font color="#cc0066">Variable type</font></strong></td>
       <td><strong><font color="#cc0066">Limits of values</font></strong></td>
       <td><strong><font color="#cc0066">Default value</font></strong></td>
</tr>



<tr>
       <td>clip to be skewed into quadrilateral or deskewed into rectangle</td>
       <td></td>
	   <td>clip</td>
       <td></td>
       <td>none</td>
</tr>

<tr>
       <td>clip to be used as background</td>
       <td></td>
	   <td>clip</td>
       <td></td>
       <td>none</td>
</tr>

<tr>
       <td>Q left top x coordinate</td>
       <td>ltopx</td>
	   <td>float</td>
       <td>none</td>
       <td>0</td>
</tr>

<tr>
       <td>Q left top y coordinate</td>
       <td>ltopy</td>
	   <td>float</td>
       <td>none</td>
       <td>0</td>
</tr>

<tr>
       <td>Q left bottom x coordinate</td>
       <td>lbotx</td>
	   <td>float</td>
       <td>none</td>
       <td>0</td>
</tr>
<tr>
       <td>Q left bot y coordinate</td>
       <td>lboty</td>
	   <td>float</td>
       <td>none</td>
       <td>frame height-1</td>
</tr>

<tr>
       <td>Q right top x coordinate</td>
       <td>rtopx</td>
	   <td>float</td>
       <td>none</td>
       <td>frame width-1</td>
</tr>

<tr>
       <td>Q right top y coordinate</td>
       <td>rtopy</td>
	   <td>float</td>
       <td>none</td>
       <td>0</td>
</tr>

<tr>
       <td>Q right bottom x coordinate</td>
       <td>rbotx</td>
	   <td>float</td>
       <td>none</td>
       <td>frame width-1</td>
</tr>
<tr>
       <td>Q right bot y coordinate</td>
       <td>rboty</td>
	   <td>float</td>
       <td>none</td>
       <td>frame height-1</td>
</tr>

<tr>
       <td>R left  x coordinate</td>
       <td>leftx</td>
	   <td>float</td>
       <td>none</td>
       <td>0</td>
</tr>

<tr>
       <td>R right x coordinate</td>
       <td>rightx</td>
	   <td>float</td>
       <td>none</td>
       <td>frame width-1</td>
</tr>

<tr>
       <td>R top y coordinate</td>
       <td>ytop</td>
	   <td>float</td>
       <td>none</td>
       <td>0</td>
</tr>
<tr>
       <td>R bottom y coordinate</td>
       <td>ybot</td>
	   <td>float</td>
       <td>none</td>
       <td>frame height-1</td>
</tr>

<tr>
       <td>End frame Q left top x coordinate </td>
       <td>eltopx</td>
	   <td>float</td>
       <td>none</td>
       <td>ltopx</td>
</tr>

<tr>
       <td>End frame Q left top y coordinate</td>
       <td>eltopy</td>
	   <td>float</td>
       <td>none</td>
       <td>ltopy</td>
</tr>

<tr>
       <td>End frame Q left bottom x coordinate</td>
       <td>elbotx</td>
	   <td>float</td>
       <td>none</td>
       <td>lbotx</td>
</tr>
<tr>
       <td>End frame Q left bot y coordinate</td>
       <td>elboty</td>
	   <td>float</td>
       <td>none</td>
       <td>lboty</td>
</tr>

<tr>
       <td>End frame Q right top x coordinate</td>
       <td>ertopx</td>
	   <td>float</td>
       <td>none</td>
       <td>rtopx</td>
</tr>

<tr>
       <td>End frame Q right top y coordinate</td>
       <td>ertopy</td>
	   <td>float</td>
       <td>none</td>
       <td>rtopy</td>
</tr>

<tr>
       <td>End frame Q right bottom x coordinate</td>
       <td>erbotx</td>
	   <td>float</td>
       <td>none</td>
       <td>rbotx</td>
</tr>
<tr>
       <td>End frame Q right bot y coordinate</td>
       <td>erboty</td>
	   <td>float</td>
       <td>none</td>
       <td>rboty</td>
</tr>

<tr>
       <td>End frame R left  x coordinate</td>
       <td>eleftx</td>
	   <td>float</td>
       <td>none</td>
       <td>leftx</td>
</tr>

<tr>
       <td>End frame R right x coordinate</td>
       <td>erightx</td>
	   <td>float</td>
       <td>none</td>
       <td>rightx</td>
</tr>

<tr>
       <td>End frame R top y coordinate</td>
       <td>eytop</td>
	   <td>float</td>
       <td>none</td>
       <td>ytop</td>
</tr>
<tr>
       <td>End frame R bottom y coordinate</td>
       <td>eybot</td>
	   <td>float</td>
       <td>none</td>
       <td>ybot</td>
</tr>
<tr>
       <td>resize interpolation to use</td>
       <td>resize</td>
	   <td>string</td>
       <td>"lanczos" "cubic" "line" "point"</td>
       <td>"lanczos"</td>
</tr>
</table>

<br>
<pre>Script examples:-
ColorBars(). converttorgb32()
bg = blankclip(last)
r2q(bg,leftx = 100,rightx = 400, ytop = 200, ybot = 480,ltopx=200,ltopy=150, rbotx = 500, rboty = 400, resize= "lanczos")
</pre>
Below is a suitably modified interesting script due to Martin53 ( sept 2012)in the quad
 plugin thread). By  commenting either r2q call or q2r call or none the power of
 the plugin can be viewed.
 <Pre>
 ColorBars(). converttoYV12()
bg = blankclip(last)
Subtitle("Flying Colorbars()",text_color=$d0c000,align=5,size=40)
 ScriptClip("""
c= last

	bg = blankclip(last)
	h = height(bg)-1
	w = width(bg)-1	
    t = 0.061 *(current_frame)
    t2 = 0.127 *( current_frame)
    a = 0.501 + 0.5 * sin(t/pi)
    t1x = (-0.2*cos(t2)) * w
    t1y = (0.5-0.5*cos(t2)) * h
    t2x = (1.0+0.2*cos(t2)) * w
    t2y = (0.5-0.5*cos(t2)) * h
    t3x = (1.0+0.2*cos(t2)) * w
    t3y = (0.5+0.5*cos(t2)) * h
    t4x = (-0.2*cos(t2)) * w
    t4y = (0.5+0.5*cos(t2)) * h
    c1x = (0.5+a*cos(t)) * w
    c1y = (0.5+a*sin(t)) * h
    c2x = (0.5-a*sin(t)) * w
    c2y = (0.5+a*cos(t)) * h
    c3x = (0.5-a*cos(t)) * w
    c3y = (0.5-a*sin(t)) * h
    c4x = (0.5+a*sin(t)) * w
    c4y = (0.5-a*cos(t)) * h
	# comment out call to r2q or to q2r or leave as it is
	r2q(c, bg,leftx=t1x,rightx=t2x,ytop=t1y,ybot=t3y,ltopx=c1x,ltopy=c1y, rtopx=c2x,rtopy=c2y,  rbotx=c3x,rboty=c3y,lbotx=c4x,lboty=c4y, resize = "point")

	q2r( bg,leftx=t1x,rightx=t2x,ytop=t1y,ybot=t3y,ltopx=c1x,ltopy=c1y, rtopx=c2x,rtopy=c2y,  rbotx=c3x,rboty=c3y,lbotx=c4x,lboty=c4y, resize = "point" )

 """)
 
 </Pre>


<BR>
<table>

<tr>
       <td><a href="../index.html">To my index page</a></td>
</tr>   
  
<tr>
       <td><a href="http://www.avisynth.nl">To Avisynth</a> </td>
</tr>
</table>	
	
</body>
</html>
